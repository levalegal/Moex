# Moex Data Fetcher

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Python-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –ë–∏—Ä–∂–∏ (MOEX).

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–±–æ—Ä –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ —Ç–æ—Ä–≥–∞—Ö (—Å–≤–µ—á–∏, —Å—Ç–∞–∫–∞–Ω—ã, —Ç–∏–∫–∏) –ø–æ —Ü–µ–Ω–Ω—ã–º –±—É–º–∞–≥–∞–º —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ API MOEX ISS. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ (`aiohttp`) –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏


*   **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:** –ë—ã—Å—Ç—Ä–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏–ª–∏ –ø–µ—Ä–∏–æ–¥–æ–≤.
*   **–ì–∏–±–∫–æ—Å—Ç—å:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ (—Å–≤–µ—á–∏) –∏ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö.
*   **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –£–¥–æ–±–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞ –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã.
*   **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫ —Ç–∏–ø–∞–º `pandas` (DateTime, numeric).
*   **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:** –ß–∏—Å—Ç—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π API.

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

*   Python 3.7+
*   [aiohttp](https://docs.aiohttp.org/) - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã
*   [pandas](https://pandas.pydata.org/) - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
*   [asyncio](https://docs.python.org/3/library/asyncio.html) - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1.  –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
    ```bash
    git clone https://github.com/ETsETs777/Moex.git
    cd Moex
    ```

2.  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
    ```bash
    pip install -r requirements.txt
    ```

    *–ï—Å–ª–∏ —Ñ–∞–π–ª–∞ `requirements.txt` –Ω–µ—Ç, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç—ã –≤—Ä—É—á–Ω—É—é:*
    ```bash
    pip install aiohttp pandas
    ```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–í–æ—Ç –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä, –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Å–≤–µ—á–∏ (–±–∞—Ä—ã) –¥–ª—è –∞–∫—Ü–∏–∏ –°–±–µ—Ä–±–∞–Ω–∫–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –¥–Ω–µ–π.

```python
import asyncio
from moex_data_fetcher import MoexFetcher

async def main():
    # –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∑–∞–≥—Ä—É–∑—á–∏–∫–∞
    fetcher = MoexFetcher()
    
    # –¢–∏–∫–µ—Ä –°–±–µ—Ä–±–∞–Ω–∫–∞
    ticker = 'SBER'
    
    # –ü–æ–ª—É—á–∞–µ–º –¥–Ω–µ–≤–Ω—ã–µ —Å–≤–µ—á–∏
    data = await fetcher.get_candles(
        security=ticker,
        interval='D',  # –î–µ–Ω—å
        count=10       # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å–≤–µ—á–µ–π
    )
    
    print(data.head())

# –ó–∞–ø—É—Å–∫–∞–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
if __name__ == "__main__":
    asyncio.run(main())
üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã
get_candles(security, interval, from_date=None, till_date=None, count=None)
–ü–æ–ª—É—á–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Å–≤–µ—á–∏ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.

security (str): –¢–∏–∫–µ—Ä —Ü–µ–Ω–Ω–æ–π –±—É–º–∞–≥–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'SBER', 'GAZP').

interval (str): –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–≤–µ—á–µ–π:

'1' - 1 –º–∏–Ω—É—Ç–∞

'10' - 10 –º–∏–Ω—É—Ç

'60' - 1 —á–∞—Å

'D' - 1 –¥–µ–Ω—å

'W' - 1 –Ω–µ–¥–µ–ª—è

'M' - 1 –º–µ—Å—è—Ü

'
from_date (str): –ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ 'YYYY-MM-DD'.

till_date (str): –ö–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ 'YYYY-MM-DD'.

count (int): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–≤–µ—á–µ–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è.

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: pandas.DataFrame —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ ['open', 'high', 'low', 'close', 'volume', 'begin', 'end'].

get_securities(board_group=None)
–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–æ—Ä–≥—É–µ–º—ã—Ö —Ü–µ–Ω–Ω—ã—Ö –±—É–º–∞–≥.

board_group (int): –§–∏–ª—å—Ç—Ä –ø–æ –≥—Ä—É–ø–ø–µ —Ä–µ–∂–∏–º–∞ —Ç–æ—Ä–≥–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: pandas.DataFrame —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –±—É–º–∞–≥–∞—Ö.

–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–ü—Ä–∏–º–µ—Ä 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥

python
data = await fetcher.get_candles(
    security='VTBR',
    interval='D',
    from_date='2024-01-01',
    till_date='2024-03-01'
)
–ü—Ä–∏–º–µ—Ä 2: –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞ –ú–æ—Å–ë–∏—Ä–∂–∏
—Ä—É—Å—Ç–æ—Ä

python
data = await fetcher.get_candles(
    security='IMOEX',
    interval='60',
    count=100
)
–ü—Ä–∏–º–µ—Ä 3: –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –∞–∫—Ü–∏–π

python
securities_df = await fetcher.get_securities()
stocks = securities_df[securities_df['type'] == 'common_share']
print(stocks[['secid', 'name']].head())
